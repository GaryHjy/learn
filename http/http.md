# http

http协议（HyperText Transfer Protocol，超文本传输协议）是因特网上应用最广泛的一种网络传输协议

设计HTTP最初的目的是为了提供一种发布和接收HTML页面的方法，它是一个基于TCP/IP通信协议来传输数据的应用层协议

- 一句话概括

HTTP是一个在计算机师姐里面专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范

- HTTP经典的几个版本

```
  1. HTTP/0.9于1990年问（备注：有些资料显示1989年）
  2. HTTP/1.0于1996年5月发布
  3. HTTP/1.1于1997年1月发布
  4. HTTP/2于2015年5月发布(不叫HTTP/2.0，是因为标准委员会不打算发布子版本，下一个版本直接是HTTP/3)
```

- HTTP存在的位置

处于TCP/IP网络分层模型中的第一层应用层

**应用层的其它协议还有**

```
  1. FTP：文件传输协议，用来在客户机和FTP服务器之间传输文件
  2. DNS域名系统：提供域名到IP地址之间的解析服务
  3. SMTP：邮件发送协议，用于通过SMTP服务器发送邮件
  4. DHCP：动态主机配置协议，DHCP服务器为客户机动态分配IP地址
  5. POP3：邮箱接收协议，用于从POP3服务器接收邮件
```

- 特点

```
  1. HTTP协议支持客户端/服务端模式，也是一种请求/响应模式的协议
  2. 灵活可扩展：一个是语义上的自由，只规定了基本格式，其它的各部门没有严格的限制；第二个它允许传输任意类型的数据对象，例如文本、图片、音频等，传输的类型有Content-Type加以标记
  3. 可靠传输，HTTP基于TCP/IP，因此把这一特性继承了下来
  4. 无状态，也就是说HTTP请求不具备保存之前发送过的请求或响应的功能，每一次请求都是独立无关的
```

**持久连接**

概念：建立一次TCP连接即可进行多次请求或响应的交互

产生原因：HTTP的初始版本是每进行一次HTTP通信就要断开一次TCP连接，下次再进行的时候又要
重新连接断开。再如今请求的资源越来越大，每次请求如果都有无谓TCP连接和断开是很大的开销

特点：只要有一方没有明确的提出断开连接，则保持TCP连接状态

优点：减少了TCP连接和断开的造成的额外开销，减轻了服务端的负载，Web页面加载变快

注意点：在HTTP/1.1中所有的连接默认都是持久连接的（也就是首部字段Connection：keep-alive，若是想要关闭则将值设置为close），但是HTTP/1.0并未标准化

（还有一个管线化的特点，同时并行发送多个请求，而不必等前一个请求完毕才能发送下一个）

- 缺点

```
  1. 明文传输（不加密），内容可能会被窃听
  2. 无法验证报文的完整性，内容可能被篡改
  3. 不验证通信方的身份，有可能遭遇伪装
  4. 无状态，它是缺点也是优点，分不同的场景
  5. 队头阻塞：每个请求都要过“独木桥”，桥宽为一个请求的宽度；也就是说，即使多个请求并行发出，也只能一个接一个地进行请求排队。
```

- HTTP的现状与痛点

HTTP1.1是划时代的，它解决了HTTP1.0的两个问题

```
  1. TCP连接无法复用，每次请求都需要重新建立TCP通道，也就是重复三次握手和四次挥手的情况，就是说每个TCP连接只能发送一个秦秋
  2. 队头阻塞，每个请求都要过“独木桥”，桥宽为一个请求的宽度；也就是说，即使多个请求并行发出，也只能一个接一个地进行请求排队
```

HTTP1.1引入

```
  1. 长连接：HTTP1.1支持长连接，且默认就开启了Connection：keep-alive，这样在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。
  2. 管线化：在长连接的基础上，管线化使得多个请求使用同一个tcp连接使请求并按照并行方式成为可能：多个请求同时发起，无需等待上一个请求回包。但是需要注意，管线化只是让请求并行，但并没有从根本上解决队头阻塞问题，因为响应仍然要遵循先进先出的原则，第一个请求的回包发出之后，才会响应第二个请求。同时，浏览器供应商很难实现管道，并且大多数浏览器默认禁用该特性，有的甚至完全删除了它。
```

HTTP1.1改进

```
  1. 缓存处理
  2. 带宽优化及网络连接的使用，比如，range头，支持断点续传功能
  3. 错误通知的增强，响应码的增强
  4. Host头处理，请求消息中如果没有Host头域会报告一个错误
```

HTTP1.1缺点

```
  1. 队头阻塞问题
  2. 明文传输，安全性有隐患
  3. header携带内容过多，增加了传输成本
  4. 默认开启keep-alive可能会给服务端造成更大的性能压力，比如对于一次性的请求，在文件被请求之后还保持了不必要的连接很长时间
```